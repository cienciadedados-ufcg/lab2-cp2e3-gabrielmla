---
title: "Emoções - Spotify"
author: "Gabriel Morais Lúcio de Araújo"
date: "2018-05-24"
output: html_document
---
<style type="text/css"> body { font-family: "Roboto", sans-serif; } body, td { font-size: 14px; } h1, h2, h3 { font-weight: bold; } code.r{ font-size: 11px; } </style>

```{r message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(comment=NA, fig.width=8, fig.align='center', fig.env='marginfigure')
library(tidyverse)
library(here)
library(gridExtra)
library(plotly)
theme_set(theme_minimal())
```

Esta análise, realizada no contexto da disciplina de Análise de Dados 1 (Ciências da Computação | UFCG), é um estudo sobre caractéristicas técnicas sobre músicas dos meus três artistas mais ouvidos de acordo com o meu perfil do [lastFm](https://www.last.fm/pt/user/gabrielmla) atualmente, sendo eles **Frank Ocean**, **Kendrick Lamar** e **Tame Impala**.

### Sobre os dados
Os dados foram obtidos a partir da API do Spotify (mais especificamente as audio_features das músicas de um artista presente na plataforma), utilizando do suporte do pacote `spotifyr` para fazer chamadas a API. Vamos então ver como funcionam os dados retornados pelo Spotify em uma pequena amostra:


```{r message=FALSE}
frank.ocean <- read_csv(here("data/frankocean.csv"))
kendrick.lamar <- read_csv(here("data/kendrick_lamar.csv"))
tame.impala <- read_csv(here("data/tame_impala.csv"))
top3.lastfm <- read_csv(here("data/top3_last.csv"))
```

```{r}
data.frank <- subset(frank.ocean, select = -c(album_uri, album_img, album_release_year, track_uri, album_popularity))
head(data.frank, 5)
```

Omiti algumas variáveis para uma melhor visualização dos dados. Como podemos ver, temos muitos dados análiticos sobre as músicas, como `danceability` (o quão dancante a música é), `energy` (o quão energética a música é), entre vários outros. Durante as visualizações irei me aprofundar mais nas variáveis utilizadas, mas sinta-se livre para explorá-los nessa tabela.

### Perguntas
* Como são as emoções dos albúns dos artistas escolhidos?
    + Existe correlação entre Loudness e Energy nas músicas?
* Músicas com maior popularidade tendem a uma maior duração de partes cantadas ou maior duração de partes instrumentais?
    + Músicas com maior popularidade tendem a ter um menor tempo de duração?
    
Sem mais delongas, vamos para a análise!

### Como são as emoções dos albúns dos artistas escolhidos?

```{r}
contour.top3.s <- subplot(
  plot_ly(x = top3.lastfm$valence, alpha = 0.6, type = 'histogram'), 
  plotly_empty(), 
  plot_ly(x = top3.lastfm$valence, y = top3.lastfm$energy, type = 'histogram2dcontour', showscale = F), 
  plot_ly(y = top3.lastfm$energy, alpha = 0.6, type = 'histogram'),
  nrows = 2, heights = c(0.2, 0.8), widths = c(0.8, 0.2), 
  shareX = TRUE, shareY = TRUE, titleX = FALSE, titleY = FALSE
)

contour.top3.plot <- layout(contour.top3.s, showlegend = FALSE)
contour.top3.plot
```

```{r}
contour.frank.plot <- plot_ly(x = ~frank.ocean$valence, y = ~frank.ocean$energy) %>% 
  add_trace(type='histogram2dcontour')
contour.frank.plot

contour.tame.plot <- plot_ly(x = ~tame.impala$valence, y = ~tame.impala$energy) %>% 
  add_trace(type='histogram2dcontour')
contour.tame.plot

contour.kendrick.plot <- plot_ly(x = ~kendrick.lamar$valence, y = ~kendrick.lamar$energy) %>% 
  add_trace(type='histogram2dcontour')
contour.kendrick.plot
```

### Existe correlação entre Loudness e Energy nas músicas?
### Músicas com maior popularidade tendem a uma maior duração de partes cantadas ou maior duração de partes instrumentais?
### Músicas com maior popularidade tendem a ter um menor tempo de duração?
